

<script src="../assets/js/stanza.js"></script>
<script>
  (function() {
    const descriptor = {"templates":{"stanza.html":"\u003ctable\u003e\n\u003cthead\u003e\n  \u003ctr\u003e\n    \u003cth\u003eID\u003c/th\u003e\u003cth\u003eName\u003c/th\u003e\u003c/th\u003e\n  \u003c/tr\u003e\n\u003c/thead\u003e\n{{#each result.body.media}}\n  \u003ctr\u003e\n    \u003ctd\u003e\u003ca href=\"http://growthmedium.org/medium/{{gm_id}}\"\u003e{{gm_id}}\u003c/a\u003e\u003c/td\u003e\n    \u003ctd\u003e{{label}}\u003c/td\u003e\n  \u003c/tr\u003e\n{{/each}}\n\u003c/table\u003e\n\n"},"parameters":[],"elementName":"togostanza-gmdb_media_by_taxid","development":false};

    if ('Promise' in window && 'URLSearchParams' in window && 'fetch' in window) {
      const Stanza = TogoStanza.initialize(descriptor);

      Stanza(function(stanza, params) {

  let formBody = [];

  for (let key in params) {
    if (params[key]) {
      formBody.push(key + "=" + endocdeURIComponent(params[key]));
    }
  };

  let options = {
    method: "POST",
    mode: "cors",
    body: formBody.join("&"),
    headers: {
      'Accept': 'application/json',
      'Content-Type': 'application/x-www-form-urlencoded'
    }
  };

  let api_url = "http://ep.dbcls.jp/sparqlist/api/";
  let api_name = "gmdb_media_by_taxid";

  let q = fetch(api_url + api_name, options).then(res=>res.json());

  q.then(function(json) {
    let data = {};
    data.body = {};
    data.body.media = [];

    for (let i =0; i < json.length; i++) {
      data.body.media.push({"gm_id": json[i].gm_id,
                            "uri": json[i].uri,
                            "label": json[i].label});
    }

    stanza.render({
      template: "stanza.html",
      parameters: {
        result: data
      }
    });
  });
});

    } else {
      const element = document.querySelector(descriptor.elementName);

      element.innerHTML = "<p>Your Web browser does not support the features required for the stanza to work. If you are using Internet Explorer 11, placing the following snippet before loading webcomponents-loader.js may resolve this issue:</p>\n<pre><code>&lt;script src=\"https://cdn.jsdelivr.net/combine/npm/@babel/polyfill@7.2.5/dist/polyfill.min.js,npm/@ungap/url-search-params@0.1.2/min.js,npm/whatwg-fetch@3.0.0/dist/fetch.umd.js\" crossorigin&gt;&lt;/script&gt;</code></pre>";
    }
  })();
</script>
